# Задание №7. Нагрузка, стресс и отказоустойчивость

## Что такое нагрузочное тестирование, тестирование отказоустойчивости и стресс-тестирование? Что их отличает друг от друга?

1. **Нагрузочное тестирование** заключается в проверке работы приложения при большой нагрузке, то есть при высоком количестве параллельных запросов. Оно позволяет определить, на какой точке насыщения выходит приложение из строя и как быстро развивается его производительность при увеличении количества пользователей. Примером может служить проверка работы онлайн-магазина в период большого скидочного предложения.

2. **Тестирование отказоустойчивости** направлено на проверку, насколько хорошо приложение справляется с сбоями и отказами в работе. Оно позволяет определить, насколько быстро система восстанавливается после сбоя и как ведёт себя приложение при возникновении критических ошибок. Примером может служить проверка работы резервной базы данных в случае выхода из строя основной.

3. **Стресс-тестирование** заключается в проверке, насколько хорошо приложение справляется с экстремальной нагрузкой и условиями. Это может быть проверка работы приложения при очень большой базе данных или при постоянных перебоях в связи с низкой скоростью подключения к интернету пользователей. Примером может служить проверка работы биржи криптовалют в условиях большой волатильности рынка.

| Нагрузочное тестирование (Load Testing)                                                                                                                                                                                                                      | Тестирование отказоустойчивости (Failover Testing)                                                                                                                                                                                                                                | Стресс-тестирование (Stress Testing)                                                                                                                                                                                         |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Нагрузочное тестирование предполагает проверку работы системы при нагрузке, близкой к максимальной. Оно позволяет определить, как система работает в условиях повышенной нагрузки и может ли она обрабатывать запросы от большого количества пользователей.  |  Тестирование отказоустойчивости уделяет особое внимание проверке возможных ситуаций отказов и их последствий.                                                                                                                                                                    | стресс-тестирование заключается в тестировании системы, когда она находится на грани и за ее пределами. То есть, ее работа проверяется в крайне экстремальных условиях, которые вряд ли могут возникнуть в боевых условиях.  |
| Целью нагрузочного тестирования является определение максимальной загрузки, которую система может выдержать.                                                                                                                                                 | Тестирование отказоустойчивости - это проверка способности системы продолжать работать при возникновении сбоев в работе компонентов. Основная цель этого тестирования - обеспечение надежности системы, т.е. ее способности работать в условиях часто возникающих ошибок и сбоев. | стресс-тестирование проводится для определения пределов работы системы, когда она перегружена или неспособна обработать запрошенные данные.                                                                                  |
| Нагрузочное тестирование проводится для определения производительности системы в условиях повышенной нагрузки и настройки ее параметров на максимальную производительность.                                                                                  | тестирование отказоустойчивости оценивает, как система справляется с ошибками и сбоями в работе                                                                                                                                                                                   | Стресс-тестирование может выступать в качестве дополнительного этапа нагрузочного тестирования, когда система тестируется на чрезвычайно высокой нагрузке для проверки ее стабильности и надежности.                         |
| Нагрузочное тестирование фокусируется на проверке работы системы в обычных условиях, когда ее нагрузка высокая                                                                                                                                               | тестирование отказоустойчивости определяется при заданной нагрузке                                                                                                                                                                                                                | Стресс-тестирование, с другой стороны, проводится для проверки способности системы справляться со стрессом и выживать в экстремальных условиях, которые редко возникают.                                                     |
| нагрузочное тестирование сосредоточено на определении ее износостойкости в условиях высокой нагрузки                                                                                                                                                         | тестирование отказоустойчивости изучается устойчивость оговоренного уровня обслуживания                                                                                                                                                                                           | стресс-тестирование предоставляет более экстремальные тестовые условия.                                                                                                                                                      |
|                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                              |



## Приведите по одному примеру выполнения каждого из трёх видов тестирования (в контексте проверки базы данных большого веб-приложения).

    Нагрузочное тестирование  используется для проверки производительности сайта или приложения при большом количестве пользователей и транзакций. Пример выполнения нагрузочного тестирования может выглядеть следующим образом:

1. Определение целей тестирования: какой максимальный поток пользователей и транзакций можно обрабатывать без потерь производительности и стабильности.

2. Взаимодействие с заказчиком: уточнение требуемых характеристик и критериев успешности тестирования.

3. Подготовка тестовых данных: создание сценария обмена информацией между пользованиями и сервисами, например, на основе использования популярных браузеров, платежных систем, соцсетей и т.д.

4. Настойка инструментария нагрузочного тестирования: включает в себя установку программного обеспечения, настройку тестовых машин, проведение мониторинга процессов и другие действия.

5. Выполнение тестов: проверка производительности приложения, установление временных показателей, определение уровня стабильности системы и другие метрики.

6. Анализ результатов: оценка полученных результатов, выявление проблем производительности приложений, определение недостатков инфраструктуры.

7. Отчет о тестировании: сообщение об ошибках, проблемных местах, заключения о выполненных метриках и других результатов.

8. Подготовка рекомендаций: на основе обнаруженных недостатков и рисков разработка рекомендаций по усовершенствованию приложения и его инфраструктуры, с целью повышения производительности и устойчивости работы.



# Пример выполнения тестирования отказоустойчивости может выглядеть следующим образом:

Шаг 1: Определить сценарии отказов

Первым шагом необходимо определить сценарии отказов, которые могут произойти с базой данных веб-приложения. Например:

- Потеря соединения с базой данных
- Недоступность базы данных из-за проблем с сетью
- Невозможность записи данных в базу из-за исчерпания максимального количества соединений
- Потеря данных в базе из-за сбоев в работе базы или хранения данных
- Нарушение целостности данных в базе из-за ошибок в приложении или базе данных

Шаг 2: Подготовить среду для тестирования

Для тестирования отказоустойчивости базы данных необходимо подготовить соответствующую тестовую среду. Это может включать в себя следующие действия:

- Создание отдельной тестовой базы данных
- Настройка параметров базы данных для симуляции отказов (например, искусственное ограничение на количество соединений)
- Настройка инструментов мониторинга для отслеживания состояния базы данных

Шаг 3: Выполнить тестовые сценарии

Для выполнения тестирования отказоустойчивости базы данных необходимо выполнить тестовые сценарии, которые были определены на первом шаге. Например:

- Отключение базы данных на несколько минут и проверка, как веб-приложение переживает отсутствие базы данных
- Установка ограничения на количество соединений и проверка, как веб-приложение обрабатывает запросы в условиях ограничения
- Имитация сбоя в работе базы данных и проверка, как веб-приложение переживает потерю данных
- Проверка, как веб-приложение обрабатывает запросы при нарушении целостности данных

Шаг 4: Анализ результатов

После выполнения тестовых сценариев необходимо проанализировать результаты и определить, насколько отказоустойчива база данных веб-приложения. Если были обнаружены проблемы, следует провести дополнительные тесты и исправить ошибки. Если база данных показала хорошие результаты, можно считать, что веб-приложение готово к работе с большими объемами данных и способно пережить некоторые типы отказов.

# Пример выполнения стресс-тестирования может выглядеть следующим образом:

Представим, что у нас есть интернет-магазин, который мы хотим протестировать на выдержку при большом количестве пользователей. Мы будем использовать специальное программное обеспечение, которое будет генерировать большое количество запросов на сайт одновременно, чтобы создать нагрузку на сервер. 

Шаги, которые мы будем выполнять:

1. Подготовка тестовой среды: мы настраиваем сервер и приложение для работы в тестовом режиме. Мы также создаем базу данных, которая будет использоваться для тестирования.

2. Создание сценария тестирования: мы определяем, какие действия будут выполняться во время тестирования. Например, мы можем создать сценарий добавления товаров в корзину, оформления заказа, выполнения поиска.

3. Выполнение теста: мы запускаем программное обеспечение для генерации запросов на сервер. Мы определяем количество пользователей и время, в течение которого тест будет выполняться. 

4. Анализ результатов: мы анализируем данные, полученные в результате тестирования, чтобы определить, какое количество пользователей может обслуживать сервер без сбоев. Мы также анализируем время отклика сервера, чтобы понимать, насколько быстро сайт будет работать при большой нагрузке. 

5. Устранение проблем: если тест выявил проблемы, мы предпринимаем меры для их устранения. Например, мы можем оптимизировать код приложения или увеличить количество серверов, чтобы распределить нагрузку.

Таким образом, стресс-тестирование поможет нам определить, какое количество пользователей может обслуживать сервер без проблем и как быстро будет работать сайт при большой нагрузке. Это позволит нам улучшить производительность и стабильность нашего интернет-магазина и обеспечить наилучший опыт покупателям.


## С помощью каких инструментов можно провести нагрузочное тестирование базы данных?

| ПО                              | Наименование производителя             | Комментарии                                                                                                                                                                                                                                                                                                    |
|---------------------------------|----------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| OpenSTA                         | 'Open System Testing Architecture'     | Свободно распространяемое программное обеспечение для нагрузочного/стресс тестирования, лицензированное GNU GPL. Использует распределённую архитектуру приложений, основанную на CORBA. Доступна версия под Windows, хотя имеются проблемы с совместимостью с Windows Vista. Поддержка прекращена в 2007 году. |
| IBM Rational Performance Tester | IBM                                    | Основанное на среде разработки Eclipse ПО, позволяющее создавать нагрузку больших объёмов и измерять время отклика для приложений с клиент-серверной архитектурой. Требует лицензирования.                                                                                                                     |
| JMeter                          | Открытый проект Apache Jakarta Project | Основанный на Java кроссплатформенный инструментарий, позволяющий производить нагрузочные тесты с использованием JDBC / FTP / LDAP / SOAP / JMS / POP3 / HTTP / TCP соединений. Даёт возможность создавать большое количество запросов с разных компьютеров и контролировать процесс с одного из них.          |
| HP LoadRunner                   | HP                                     | Инструмент для нагрузочного тестирования, изначально разработанный для эмуляции работы большого количества параллельно работающих пользователей. Также может быть использован для unit- или интеграционного тестирования.                                                                                      |
| LoadComplete                    | SmartBear                              | Проприетарный продукт, позволяющий проводить нагрузочное тестирование веб-приложений                                                                                                                                                                                                                           |
| SilkPerformer                   | Micro Focus (Borland)                  |                                                                                                                                                                                                                                                                                                                |
| Siege                           | Joe Dog Software                       | Siege — это утилита для нагрузочного тестирования веб-серверов.                                                                                                                                                                                                                                             |
| Visual Studio Team System       | Microsoft                              | Visual Studio предоставляет инструмент для тестирования производительности включая load / unit testing                                                                                                                                                                                                         |
| QTest                           | Quotium                                |                                                                                                                                                                                                                                                                                                                |
| HTTPerf                         |                                        |                                                                                                                                                                                                                                                                                                                |
| QALoad                          | Compuware Ltd.                         |                                                                                                                                                                                                                                                                                                                |
| (The) Grinder                   |                                        |                                                                                                                                                                                                                                                                                                                |


## Какие существуют способы оптимизации (улучшения производительности) базы данных?

Существуют различные способы оптимизации базы данных, которые могут значительно улучшить ее производительность:

Индексирование базы данных - создание индексов для быстрого поиска данных.

Нормализация - разделение таблиц на отдельные сущности для уменьшения дублирования данных и повышения производительности.

Оптимизация запросов - использование оптимизатора запросов, написание эффективных запросов и устранение избыточных запросов.

Правильный выбор типов данных - использование подходящих типов данных для колонок таблицы, что позволяет сохранять память и повышает производительность.

Разделение на разные таблицы - использование разных таблиц для разных типов данных, что позволяет улучшить производительность.

Кеширование - использование кэша для хранения результата запросов, что может значительно уменьшить время выполнения запросов.

Партиционирование - разделение таблиц на разные части для более быстрого доступа к данным.

Масштабирование - разделение базы данных на несколько серверов, что позволяет распределить нагрузку и повысить производительность.

Анализ производительности - использование инструментов для мониторинга производительности базы данных и поиска узких мест для оптимизации.